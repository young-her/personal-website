---
title: "TypeScript è¿›é˜¶æŠ€å·§ä¸æœ€ä½³å®è·µ"
description: "æ·±å…¥æ¢ç´¢ TypeScript çš„é«˜çº§ç‰¹æ€§ï¼Œåˆ†äº«å®ç”¨çš„ç±»å‹ç¼–ç¨‹æŠ€å·§å’Œæœ€ä½³å®è·µã€‚"
date: "2025-07-05"
author: "ç«™é•¿"
tags: ["TypeScript", "JavaScript", "ç±»å‹ç³»ç»Ÿ", "å‰ç«¯å¼€å‘", "ç¼–ç¨‹æŠ€å·§"]
published: true
---

# TypeScript è¿›é˜¶æŠ€å·§ä¸æœ€ä½³å®è·µ

TypeScript ä¸ä»…ä»…æ˜¯ JavaScript çš„ç±»å‹æ£€æŸ¥å™¨ï¼Œå®ƒè¿˜æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç±»å‹ç¼–ç¨‹å·¥å…·ã€‚æœ¬æ–‡å°†åˆ†äº«ä¸€äº›è¿›é˜¶æŠ€å·§ï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°åˆ©ç”¨ TypeScript çš„ç±»å‹ç³»ç»Ÿã€‚

## ğŸ¯ é«˜çº§ç±»å‹æŠ€å·§

### 1. æ¡ä»¶ç±»å‹ï¼ˆConditional Typesï¼‰

æ¡ä»¶ç±»å‹å…è®¸æˆ‘ä»¬æ ¹æ®ç±»å‹æ¡ä»¶åˆ›å»ºçµæ´»çš„ç±»å‹ï¼š

```typescript
type NonNullable<T> = T extends null | undefined ? never : T

// å®ç”¨ç¤ºä¾‹ï¼šæå–æ•°ç»„å…ƒç´ ç±»å‹
type ArrayElement<T> = T extends (infer U)[] ? U : never

type StringArray = string[]
type Element = ArrayElement<StringArray> // string
```

### 2. æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰

åˆ›å»ºåŸºäºç°æœ‰ç±»å‹çš„æ–°ç±»å‹ï¼š

```typescript
// å°†æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰
type Partial<T> = {
  [P in keyof T]?: T[P]
}

// å°†æ‰€æœ‰å±æ€§å˜ä¸ºåªè¯»
type Readonly<T> = {
  readonly [P in keyof T]: T[P]
}

// å®ç”¨ç¤ºä¾‹ï¼šåˆ›å»º API å“åº”ç±»å‹
type ApiResponse<T> = {
  data: T
  status: 'success' | 'error'
  message?: string
}

type UserResponse = ApiResponse<User>
```

### 3. æ¨¡æ¿å­—é¢é‡ç±»å‹

æ„å»ºåŠ¨æ€å­—ç¬¦ä¸²ç±»å‹ï¼š

```typescript
type EventName<T extends string> = `on${Capitalize<T>}`

type ClickEvent = EventName<'click'> // 'onClick'
type HoverEvent = EventName<'hover'> // 'onHover'

// è·¯ç”±ç±»å‹å®‰å…¨
type Route = '/home' | '/about' | '/contact'
type ApiRoute<T extends Route> = `/api${T}`

type HomeApi = ApiRoute<'/home'> // '/api/home'
```

## ğŸ›¡ï¸ ç±»å‹å®‰å…¨ç­–ç•¥

### 1. ä¸¥æ ¼çš„ TSConfig é…ç½®

```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "noImplicitReturns": true,
    "noImplicitThis": true,
    "noUncheckedIndexedAccess": true,
    "exactOptionalPropertyTypes": true
  }
}
```

### 2. è¿è¡Œæ—¶ç±»å‹éªŒè¯

ç»“åˆ Zod è¿›è¡Œè¿è¡Œæ—¶éªŒè¯ï¼š

```typescript
import { z } from 'zod'

const UserSchema = z.object({
  id: z.number(),
  name: z.string(),
  email: z.string().email(),
  age: z.number().min(0).max(120),
})

type User = z.infer<typeof UserSchema>

function createUser(data: unknown): User {
  return UserSchema.parse(data) // è¿è¡Œæ—¶éªŒè¯
}
```

### 3. å“ç‰Œç±»å‹ï¼ˆBranded Typesï¼‰

é˜²æ­¢åŸºæœ¬ç±»å‹çš„è¯¯ç”¨ï¼š

```typescript
type UserId = number & { __brand: 'UserId' }
type PostId = number & { __brand: 'PostId' }

function createUserId(id: number): UserId {
  return id as UserId
}

function createPostId(id: number): PostId {
  return id as PostId
}

function getUserById(id: UserId): User {
  // ç¼–è¯‘æ—¶ç¡®ä¿ä¼ å…¥æ­£ç¡®çš„ ID ç±»å‹
  return users.find(user => user.id === id)
}

// é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…
// getUserById(createPostId(123)) // âŒ
// æ­£ç¡®ï¼šç±»å‹åŒ¹é…
getUserById(createUserId(123)) // âœ…
```

## ğŸ—ï¸ æ¶æ„æ¨¡å¼

### 1. ä¾èµ–æ³¨å…¥æ¨¡å¼

```typescript
interface Logger {
  log(message: string): void
}

interface Database {
  save<T>(entity: T): Promise<T>
  find<T>(id: string): Promise<T | null>
}

class UserService {
  constructor(
    private logger: Logger,
    private database: Database
  ) {}

  async createUser(userData: CreateUserRequest): Promise<User> {
    this.logger.log('Creating user...')
    return this.database.save(userData)
  }
}

// ä½¿ç”¨
const logger: Logger = new ConsoleLogger()
const database: Database = new PostgresDatabase()
const userService = new UserService(logger, database)
```

### 2. å·¥å‚æ¨¡å¼

```typescript
interface Shape {
  area(): number
}

class Circle implements Shape {
  constructor(private radius: number) {}
  area(): number {
    return Math.PI * this.radius ** 2
  }
}

class Rectangle implements Shape {
  constructor(private width: number, private height: number) {}
  area(): number {
    return this.width * this.height
  }
}

type ShapeType = 'circle' | 'rectangle'

class ShapeFactory {
  static create(type: ShapeType, ...args: number[]): Shape {
    switch (type) {
      case 'circle':
        return new Circle(args[0])
      case 'rectangle':
        return new Rectangle(args[0], args[1])
      default:
        throw new Error(`Unknown shape type: ${type}`)
    }
  }
}
```

## ğŸ¨ å®ç”¨å·¥å…·ç±»å‹

### 1. æ·±åº¦ç±»å‹æ“ä½œ

```typescript
// æ·±åº¦å¯é€‰
type DeepPartial<T> = {
  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]
}

// æ·±åº¦åªè¯»
type DeepReadonly<T> = {
  readonly [P in keyof T]: T[P] extends object ? DeepReadonly<T[P]> : T[P]
}

// é€‰æ‹©ç‰¹å®šé”®
type Pick<T, K extends keyof T> = {
  [P in K]: T[P]
}

// æ’é™¤ç‰¹å®šé”®
type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>
```

### 2. å‡½æ•°ç±»å‹å·¥å…·

```typescript
// æå–å‡½æ•°å‚æ•°ç±»å‹
type Parameters<T extends (...args: any) => any> = 
  T extends (...args: infer P) => any ? P : never

// æå–å‡½æ•°è¿”å›ç±»å‹
type ReturnType<T extends (...args: any) => any> = 
  T extends (...args: any) => infer R ? R : any

// å®ç”¨ç¤ºä¾‹
function processUser(id: number, name: string): Promise<User> {
  // å®ç°...
}

type ProcessUserParams = Parameters<typeof processUser> // [number, string]
type ProcessUserReturn = ReturnType<typeof processUser> // Promise<User>
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. ç±»å‹ç¼“å­˜

```typescript
// é¿å…å¤æ‚ç±»å‹é‡å¤è®¡ç®—
type ExpensiveType<T> = /* å¤æ‚çš„ç±»å‹æ“ä½œ */

// ä½¿ç”¨ç±»å‹åˆ«åç¼“å­˜ç»“æœ
type CachedExpensiveType<T> = ExpensiveType<T>
```

### 2. é€’å½’ç±»å‹ä¼˜åŒ–

```typescript
// é™åˆ¶é€’å½’æ·±åº¦
type DeepPartial<T, D extends number = 5> = 
  D extends 0 
    ? T 
    : {
        [P in keyof T]?: T[P] extends object 
          ? DeepPartial<T[P], Prev<D>>
          : T[P]
      }

type Prev<T extends number> = [-1, 0, 1, 2, 3, 4, 5][T]
```

## ğŸ§ª æµ‹è¯•ç±»å‹

```typescript
// ç±»å‹æµ‹è¯•å·¥å…·
type Expect<T extends true> = T
type Equal<X, Y> = (<T>() => T extends X ? 1 : 2) extends 
  (<T>() => T extends Y ? 1 : 2) ? true : false

// æµ‹è¯•ç¤ºä¾‹
type Test1 = Expect<Equal<Pick<User, 'id'>, { id: number }>>
type Test2 = Expect<Equal<Omit<User, 'id'>, { name: string; email: string }>>
```

## ğŸ“š æœ€ä½³å®è·µæ€»ç»“

1. **ä¼˜å…ˆä½¿ç”¨ç±»å‹æ¨æ–­**ï¼šè®© TypeScript è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œåªåœ¨å¿…è¦æ—¶æ˜¾å¼å£°æ˜

2. **åˆç†ä½¿ç”¨ `any`**ï¼šé¿å…ä½¿ç”¨ `any`ï¼Œè€ƒè™‘ä½¿ç”¨ `unknown` æˆ–å…·ä½“çš„è”åˆç±»å‹

3. **åˆ©ç”¨ä¸¥æ ¼æ¨¡å¼**ï¼šå¯ç”¨æ‰€æœ‰ä¸¥æ ¼æ£€æŸ¥é€‰é¡¹

4. **ç»„åˆè€Œéç»§æ‰¿**ï¼šä¼˜å…ˆä½¿ç”¨æ¥å£ç»„åˆå’Œè”åˆç±»å‹

5. **ç±»å‹å®ˆå«**ï¼šä½¿ç”¨ç±»å‹å®ˆå«ç¡®ä¿è¿è¡Œæ—¶ç±»å‹å®‰å…¨

```typescript
function isString(value: unknown): value is string {
  return typeof value === 'string'
}

function processValue(value: unknown) {
  if (isString(value)) {
    // è¿™é‡Œ value è¢«æ­£ç¡®æ¨æ–­ä¸º string
    console.log(value.toUpperCase())
  }
}
```

## ç»“è¯­

TypeScript çš„ç±»å‹ç³»ç»Ÿéå¸¸å¼ºå¤§ï¼ŒæŒæ¡è¿™äº›è¿›é˜¶æŠ€å·§å¯ä»¥å¸®åŠ©ä½ ï¼š

- ç¼–å†™æ›´å®‰å…¨ã€æ›´å¯ç»´æŠ¤çš„ä»£ç 
- æä¾›æ›´å¥½çš„å¼€å‘ä½“éªŒ
- å‡å°‘è¿è¡Œæ—¶é”™è¯¯
- æå‡ä»£ç çš„è‡ªæ–‡æ¡£åŒ–ç¨‹åº¦

è®°ä½ï¼Œç±»å‹ç³»ç»Ÿæ˜¯ä¸ºäº†å¸®åŠ©å¼€å‘ï¼Œè€Œä¸æ˜¯é˜»ç¢å¼€å‘ã€‚åœ¨å¤æ‚æ€§å’Œå®ç”¨æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡æ˜¯å…³é”®ã€‚ 