---
title: "Next.js 15 æœ€ä½³å®è·µæŒ‡å—"
description: "æ¢ç´¢ Next.js 15 çš„æ–°ç‰¹æ€§å’Œå¼€å‘æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬ App Routerã€Server Components ç­‰ã€‚"
date: "2025-07-06"
author: "ç«™é•¿"
tags: ["Next.js", "React", "æœ€ä½³å®è·µ", "App Router", "å‰ç«¯å¼€å‘"]
published: true
---

# Next.js 15 æœ€ä½³å®è·µæŒ‡å—

Next.js 15 å¸¦æ¥äº†è®¸å¤šä»¤äººå…´å¥‹çš„æ–°ç‰¹æ€§å’Œæ”¹è¿›ã€‚æœ¬æ–‡å°†åˆ†äº«ä¸€äº›å…³é”®çš„æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ æ›´å¥½åœ°åˆ©ç”¨è¿™ä¸ªå¼ºå¤§çš„æ¡†æ¶ã€‚

## ğŸš€ App Router æœ€ä½³å®è·µ

### æ–‡ä»¶ç»“æ„ç»„ç»‡

ä½¿ç”¨ App Router æ—¶ï¼Œå»ºè®®é‡‡ç”¨åŠŸèƒ½é©±åŠ¨çš„æ–‡ä»¶ç»“æ„ï¼š

```
app/
â”œâ”€â”€ (marketing)/          # è·¯ç”±ç»„
â”‚   â”œâ”€â”€ page.tsx         # é¦–é¡µ
â”‚   â””â”€â”€ about/
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ layout.tsx       # åµŒå¥—å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ settings/
â””â”€â”€ api/
    â””â”€â”€ users/
        â””â”€â”€ route.ts     # API è·¯ç”±
```

### Server Components vs Client Components

**ä¼˜å…ˆä½¿ç”¨ Server Componentsï¼š**

```tsx
// app/posts/page.tsx (Server Component)
import { getPosts } from '@/lib/posts'

export default async function PostsPage() {
  const posts = await getPosts() // åœ¨æœåŠ¡å™¨ç«¯è·å–æ•°æ®
  
  return (
    <div>
      {posts.map(post => (
        <PostCard key={post.id} post={post} />
      ))}
    </div>
  )
}
```

**åªåœ¨å¿…è¦æ—¶ä½¿ç”¨ Client Componentsï¼š**

```tsx
'use client'

import { useState } from 'react'

export function SearchBox() {
  const [query, setQuery] = useState('')
  
  return (
    <input
      value={query}
      onChange={(e) => setQuery(e.target.value)}
      placeholder="æœç´¢..."
    />
  )
}
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. å›¾ç‰‡ä¼˜åŒ–

ä½¿ç”¨ Next.js çš„ `Image` ç»„ä»¶è‡ªåŠ¨ä¼˜åŒ–å›¾ç‰‡ï¼š

```tsx
import Image from 'next/image'

export function Hero() {
  return (
    <Image
      src="/hero.jpg"
      alt="Hero image"
      width={1200}
      height={600}
      priority // é¦–å±å…³é”®å›¾ç‰‡
      placeholder="blur"
      blurDataURL="data:image/jpeg;base64,..."
    />
  )
}
```

### 2. å­—ä½“ä¼˜åŒ–

ä½¿ç”¨ `next/font` ä¼˜åŒ–å­—ä½“åŠ è½½ï¼š

```tsx
import { Inter } from 'next/font/google'

const inter = Inter({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-inter',
})

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html className={inter.variable}>
      <body className="font-sans">
        {children}
      </body>
    </html>
  )
}
```

### 3. æ•°æ®è·å–ä¼˜åŒ–

```tsx
// å¹¶è¡Œæ•°æ®è·å–
export default async function DashboardPage() {
  const [user, posts, analytics] = await Promise.all([
    getUser(),
    getPosts(),
    getAnalytics(),
  ])

  return (
    <Dashboard 
      user={user} 
      posts={posts} 
      analytics={analytics} 
    />
  )
}
```

## ğŸ›¡ï¸ å®‰å…¨æœ€ä½³å®è·µ

### 1. ç¯å¢ƒå˜é‡ç®¡ç†

```typescript
// lib/env.ts
import { z } from 'zod'

const envSchema = z.object({
  DATABASE_URL: z.string(),
  NEXTAUTH_SECRET: z.string(),
  NEXT_PUBLIC_APP_URL: z.string().url(),
})

export const env = envSchema.parse(process.env)
```

### 2. API è·¯ç”±ä¿æŠ¤

```typescript
// app/api/admin/route.ts
import { auth } from '@/lib/auth'

export async function GET(request: Request) {
  const session = await auth()
  
  if (!session?.user?.isAdmin) {
    return new Response('Unauthorized', { status: 401 })
  }
  
  // ç®¡ç†å‘˜æ“ä½œ...
}
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```tsx
// __tests__/components/Button.test.tsx
import { render, screen } from '@testing-library/react'
import { Button } from '@/components/ui/button'

describe('Button', () => {
  it('renders with correct text', () => {
    render(<Button>Click me</Button>)
    expect(screen.getByRole('button')).toHaveTextContent('Click me')
  })
})
```

### E2E æµ‹è¯•

```typescript
// e2e/auth.spec.ts
import { test, expect } from '@playwright/test'

test('user can sign in', async ({ page }) => {
  await page.goto('/signin')
  await page.fill('[name="email"]', 'user@example.com')
  await page.fill('[name="password"]', 'password')
  await page.click('button[type="submit"]')
  
  await expect(page).toHaveURL('/dashboard')
})
```

## ğŸ“¦ ä¾èµ–ç®¡ç†

### æ¨èçš„åŒ…ç»„åˆ

```json
{
  "dependencies": {
    "next": "^15.0.0",
    "react": "^18.2.0",
    "@tanstack/react-query": "^5.0.0",
    "zod": "^3.22.0",
    "tailwindcss": "^3.4.0"
  },
  "devDependencies": {
    "@playwright/test": "^1.40.0",
    "jest": "^29.7.0",
    "@testing-library/react": "^14.1.0"
  }
}
```

## ğŸš¢ éƒ¨ç½²ä¼˜åŒ–

### Vercel éƒ¨ç½²é…ç½®

```json
// vercel.json
{
  "buildCommand": "npm run build",
  "outputDirectory": ".next",
  "framework": "nextjs",
  "regions": ["hnd1", "sfo1"],
  "functions": {
    "app/api/**": {
      "maxDuration": 30
    }
  }
}
```

### Docker éƒ¨ç½²

```dockerfile
FROM node:18-alpine AS deps
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine AS builder
WORKDIR /app
COPY . .
COPY --from=deps /app/node_modules ./node_modules
RUN npm run build

FROM node:18-alpine AS runner
WORKDIR /app
ENV NODE_ENV production
COPY --from=builder /app/.next ./.next
COPY --from=builder /app/public ./public
COPY --from=builder /app/package.json ./package.json

EXPOSE 3000
CMD ["npm", "start"]
```

## æ€»ç»“

Next.js 15 æä¾›äº†å¼ºå¤§çš„åŠŸèƒ½æ¥æ„å»ºç°ä»£ Web åº”ç”¨ã€‚é€šè¿‡éµå¾ªè¿™äº›æœ€ä½³å®è·µï¼š

- åˆç†ä½¿ç”¨ Server å’Œ Client Components
- ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- ç¡®ä¿åº”ç”¨å®‰å…¨æ€§
- å»ºç«‹å®Œå–„çš„æµ‹è¯•ç­–ç•¥
- ä¼˜åŒ–éƒ¨ç½²æµç¨‹

ä½ å¯ä»¥æ„å»ºå‡ºé«˜è´¨é‡ã€å¯ç»´æŠ¤çš„åº”ç”¨ç¨‹åºã€‚è®°ä½ï¼Œæœ€ä½³å®è·µä¼šéšç€æ¡†æ¶çš„å‘å±•è€Œæ¼”è¿›ï¼ŒæŒç»­å­¦ä¹ å’Œé€‚åº”æ˜¯å…³é”®ã€‚ 